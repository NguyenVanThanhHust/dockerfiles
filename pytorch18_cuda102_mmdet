from pytorch/pytorch:1.8.1-cuda10.2-cudnn7-runtime
RUN pip install opencv-python einops matplotlib jpeg4py \
        tqdm timm pyyaml yacs easydict tensorboardX
RUN apt-get update && apt-get -y install libgl1
RUN apt-get update -y && apt install -y build-essential
RUN apt-get update -y && apt-get install -y libglib2.0-0 git vim fish
RUN pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu102/torch1.8.1/index.html
RUN git clone https://github.com/open-mmlab/mmdetection.git

WORKDIR /workspace/mmdetection/
RUN pip install -r requirements/build.txt
RUN pip install "git+https://github.com/open-mmlab/cocoapi.git#subdirectory=pycocotools"
RUN python setup.py install

WORKDIR /workspace/

