from pytorch/pytorch:1.8.1-cuda10.2-cudnn7-runtime
RUN pip install opencv-python einops matplotlib jpeg4py \
        tqdm timm pyyaml yacs easydict tensorboardX
RUN apt-get update && apt-get -y install libgl1
RUN apt-get update -y && apt install -y build-essential
RUN apt-get update -y && apt-get install -y libglib2.0-0 git vim fish
WORKDIR /workspace/extra_library/
RUN git clone -b v1.4.5 https://github.com/open-mmlab/mmcv.git
RUN git clone -b v2.20.0 https://github.com/open-mmlab/mmdetection.git
WORKDIR /workspace/extra_library/mmcv/
RUN MMCV_WITH_OPS=1 python3.7 setup.py install
WORKDIR /workspace/extra_library/mmdetection/
RUN pip install -r requirements/build.txt
RUN pip install "git+https://github.com/open-mmlab/cocoapi.git#subdirectory=pycocotools"
RUN python3.7 setup.py install
WORKDIR /workspace/
RUN python3.7 -m pip install numpy==1.21.2  opencv-python==4.5.5.62 terminaltables==3.1.10 matplotlib==3.5.1 pillow==8.4.0 mmcls==0.19.0 
WORKDIR /workspace/extra_library/
RUN git clone https://github.com/open-mmlab/mmfewshot.git
WORKDIR /workspace/extra_library/mmfewshot
RUN python3.7 setup.py install
WORKDIR /workspace/

